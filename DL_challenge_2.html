---
layout: challenge
title: Challenge level 2
permalink: /DL/challenge2
---


    <!-- Intro to challenge -->
<section id="portfolio-work" style= "background-image: url({{ site.baseurl }}/img/DL-ccbanner-teal.png); color: white">

        <div class="container">
         <center><h2>Data visualisation challenge: Native woodlands </h2></center>
            <p></p>
          <p> This challenge will require the use of data manipulation, plotting and mapping skills, and is the culmination of the <a href="https://ourcodingclub.github.io/course/wiz-viz.html" target="_blank" style="color: #e6e7eb;"><i>WIZ OF DATA VIS</i></a> course stream. Scroll for more information on your tasks and how to complete the challenge. </p>
        
</div>

</section>

<!-- Challenge context and objectives -->
<section id="challenge2intro" class="feature">
 
   <div class="container">
      <btn-switch onclick="toggle(challenge2intro)" style="float: right;"> Hide/show background </btn-switch> 
  <div class="row">
    <div class="col-md-6">
      <h2>Challenge outline and objectives</h2>
      <p>While Scotland is best known for its endless rolling heather hills, it used to be covered in wide swathes of forest. Less than 20% of Scotland is now afforested, and only 4% of the territory consists of native woodlands (<a href="https://www.woodlandtrust.org.uk/about-us/where-we-work/scotland/" target="_blank">Woodland Trust</a>, <a href="https://www.nature.scot/professional-advice/land-and-sea-management/managing-land/forests-and-woodlands/woodland-expansion-across-scotland" target="_blank">Scottish Natural Heritage</a>). </p>
      
      <p>The Scottish government has included woodland expansion goals in its Climate Change plan, and several governmental and non governmental organisations are working towards the creation of new woodlands that will support native species and provide a wider range of ecosystem services than just timber. </p>
      
      <p>You have been asked to provide a report on the extent and structure of some high-priority conservation habitats in national nature reserves (NNR) of Scotland. For selected woodland types, you are required to prepare maps of their distribution in the Cairngorms, the Glen Affric, and the Trossachs nature reserve areas. You have also been tasked to calculate their respective extent within the reserve boundaries, and some basic biodiversity indices.<p>

    </div>
  </div>
</div>
</section>

  <!-- Data section -->
<section id="portfolio-work" style= "background-color: #324c58; color: white">

        <div class="container">
         <center><h2>Data overview </h2></center>
         
          <h3> You will use the following datasets, available from the <a href="https://github.com/ourcodingclub/CC_course_challenge2" target="_blank">Challenge repository</a> on GitHub. To be able to answer the quiz questions properly, it is important that you use these datasets and not potentially updated versions available through the original providers. <br> </h3>
          
          <p><b>NOTE:</b> The data files have been saved as RDS objects because of their relatively large size. You can easily read a RDS file in R using the <a href = "https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/readRDS" target="_blank">readRDS()</a> function.</p>
          
          <b><h2>Native Woodland Survey of Scotland</h2></b>
          
          <li><b>NWSS.RDS</b>, a shapefile of all woodland patches in Scotland. The most important variables in the dataset are: <ul>
             <li>- <b>DOM_HABITA</b>: the main habitat type for the polygon. We will only keep some priority habitats, listed in the specific tasks (INTERNAL LINK)</li>
             <li>- <b>HECTARES</b>: the area of a given patch</li>
          </ul>
          
          <br>Original data link <a href="http://data-forestry.opendata.arcgis.com/datasets/feadebb6bbf844a7bfdb5c8a7b9f73d7_0" target="_blank">here</a> and more information about the survey <a href="https://forestry.gov.scot/forests-environment/biodiversity/native-woodlands/native-woodland-survey-of-scotland-nwss" target="_blank">here</a>.</li>
          
          <br>
           <li><b>species_structure.RDS</b>, a spreadsheet containing tree species information from the woodlands. The most important variables in the dataset are: <ul>
              
              <li>- <b>SCPTDATA_I</b>: a unique identifier code that will allow to match the observations to the spatial data in <b>FCPRODUCT S NWSS</b></li>
              
              <li>- <b>SPECIES</b>: the name of the species recorded</li>
              
              <li>- <b>ESTIMT_HA</b>: the estimated area, in hectares, covered by a given species at this location</li>
           </ul>
           
           <br>Original data link <a href="http://data-forestry.opendata.arcgis.com/datasets/feadebb6bbf844a7bfdb5c8a7b9f73d7_6" target="_blank">here</a>. </li>
           <br>
          
          <b><h2>National Nature Reserves</h2></b>
          
      <p>A shapefile containing the outlines of Scotland's <a href="https://www.nnr.scot/" target="_blank">NNRs</a>. The most important variables in the dataset are: </p><ul>

<li>-	<b>NAME</b>: The name of the reserve </li>
<li>-	<b>SITE_HA</b>: The area of the site in hectares</li> </ul>
      
      <br>Original data link <a href="https://gateway.snh.gov.uk/natural-spaces/dataset.jsp?dsid=NNR" target="_blank">here</a>.
        
</div>

</section>

<!-- Spatial info -->
<section id = "spatial" style= "background-color: #f1d13a; color: #2b3138">
   <div class="container">
   
   <div class="row-eq-height">
      
      <div class="col-md-5 col-sm-12">
        <div class="block"> 
        <center><img src="{{ site.baseurl }}/img/DL/earth.png" style= "height:200px; width:auto" alt="spatial-logo"></center>
        </div>
      </div>
      
      <div class="col-md-7 col-sm-12">
        <div class="block">        
   <h2>About spatial data</h2>
   <p>Two of the three datasets are <b>shapefiles</b>, which means that they contain geometric information that allow the data to be represented as shapes (polygons), points or lines. But don't panic! When you import the files into R, you will see that you can preview and manipulate the data much like any other dataframe.</p>
   
   <p>The spatial objects have been saved using the <a href="https://r-spatial.github.io/sf/articles/sf1.html" target="_blank">sf package</a> which allows for integration with the tidyverse: the <i>sf</i> functions are pipe-friendly and you can pretty much do everything to a <i>sf</i> object that you would do to a regular dataframe (e.g. merge with another dataset, subset to some values or conditions, etc). Remember, in the end, a spatial dataset is just like any other dataset, with extra geographic information tucked in one column!</p>
   
   <p>You will not have to do any complex spatial analysis for this, but the instructions will point you in the right direction when functions specific to the <i>sf</i> package might be needed. More <a href="#hints">hints</a> can be found at the bottom of the page.</p>
      </div>
     </div>
      
   </div>

</div>
</section>


   <!-- Tasks -->

<!-- Step 1 clean -->   
<section id="portfolio-work" style= "background-color: #334b3b; color: #ffffff">

        <div class="container">
           
   <center><h2>Specific tasks </h2></center>
      
      <p>Here is a detailed list of the tasks you should achieve within this challenge. Remember that a challenge is meant to be, well, challenging, and therefore we are setting you goals but the choice of workflow and functions to achieve them is up to you! We also list the questions that will be asked in the quiz at the end to confirm your successful completion - we suggest you take note of your answers as you go.</p>

   <div class="row-eq-height">
      <div class="col-md-8 col-sm-12">
        <div class="block">        
   <h3><b>1. Clean the data </b></h3>
      
<p>You will need to clean and filter the data to the sites and woodland types of interest. Specifically, you should: </p>

<li>	Restrict the NWSS observations to the following <b>dominant habitat types</b>: </li>
<ul>
<li> - Native pinewood</li>
<li> - Upland birchwood</li>
<li> - Upland mixed ashwood</li>
<li> - Upland oakwood </li>
<li> - Wet woodland</li>
<li> - Lowland mixed deciduous woodland</li>
</ul><br>

<li>	Restrict the NNR shapefile to the <b>following areas</b>, lump the last three under the same name, and rename as indicated: 
<ul>
<li> - The Great Trossachs Forest (rename to "Trossachs")</li>
<li> - Glen Affric (leave as such)</li>
<li> - Cairngorms (part of the "Cairngorms" group)</li>
<li> - Mar Lodge Estate (part of the "Cairngorms" group)</li>
<li> - Abernethy (part of the "Cairngorms" group)</li>
</ul></li>

<i>NB: There are 6 more NNRs within the Cairngorms National Park, but these three are large ones within the core of the park, and the only ones we'll be considering for this analysis.</i> <br>

<p><b>HINT:</b>Once you have filtered both datasets to only keep the regions and habitats of interest, the best way forward is to create <b>one object</b> that combines the two: i.e. only keep the habitats of interest <i>that are found within</i> the regions of interest. You may need some indepent research to figure it out, but only one function from the <i>sf</i> package is required to achieve this. To get you started, know that all <i>sf</i>functions begin with <i>"st_"</i>, and this type of spatial operation is called an <i>intersection</i>...</p>

        </div>
      </div>
      
   <div class="col-md-4 col-sm-12">
      <div class="block"> 
        <center><img src="{{ site.baseurl }}/img/DL/broomlight.png" style= "height:200px; width:auto" alt="spatial-logo"></center>
       </div>
   </div>
      
   </div>

</div>
</section>

<!-- Step 2 Map -->
<section id="portfolio-work" style= "background-color: #f2f3f3; color: #2b3138">

   <div class="container">

<div class="row-eq-height">
   
   <div class="col-md-4 col-sm-12">
      <div class="block"> 
        <center><img src="{{ site.baseurl }}/img/DL/map.png" style= "height:200px; width:auto" alt="spatial-logo"></center>
       </div>
   </div>
   
   <div class="col-md-4 col-sm-12">
      <div class="block">
   
   <h3> <b>2. Map the areas of interest </b></h3>
    
<p>Create a map for each of the three areas (Cairngorms, Trossachs, and Glen Affric) showing the geographical distribution of the priority habitats. Specifically, you should: </p>

<li>Create a colour palette that you will use consistently to refer to the habitat types </li>
<li>Produce a map for each region, complete with a legend. </li>

<li></li>

<p>Be prepared to answer the question: </p>

<li>What type(s) of priority habitat is (are) found in the Trossachs but not in the other two areas? </li>

<p><b>HINT:</b>Producing a map is not very different than producing any other plot. The <i>sf</i> package integrates almost seamlessly with <i>ggplot2</i>, so you can use all your favourite ways of selecting colours based on factor levels, adding text and legends, etc. The only difference is that the <i>sf</i> objects are called in your plot through <i>geom_sf</i>. </p>

       </div>
   </div>
</div>
         
</div>
</section>

<!-- Step 3 area -->
<section id="portfolio-work" style= "background-color: #334b3b; color: #ffffff">

        <div class="container">
           
   <h3> <b>3. Calculate the proportion of land (in %) covered by each habitat in the three areas. </b></h3>
      
<p> The total NNR area is found in the cell SITE_HA, and the habitat polygon size is contained in the cell HECTARES. <i>(Note that there are more than one polygon per habitat type! Think about grouping observations first.)</i> Specifically, you should: </p>

<li>	Create a graph of your choice to represent the proportion of each habitat within the reserves </li>

<li>	Be prepared to answer the question: 
<ul>
<li> - <i>“What proportion of Glen Affric is covered in pinewoods?”</i></li>
</ul>
         </li>

</div>
</section>

<!-- Step 4 biodiv -->
<section id="portfolio-work" style= "background-color: #334b3b; color: #ffffff">

        <div class="container">
<h3> <b>4. Calculate the species richness and evenness of the three areas. </b></h3>
      
<p> <b>Species richness</b> simply corresponds to the number of different species in each area. <i>(Tip: all the species information is found in the Species Structure dataset.)</i> </p>

<p><b>Species evenness</b> is a value between 0 (not even at all) and 1 (perfectly even) indicating how equitably species are represented, abundance-wise (i.e., is there one very dominant species, or are all species found in similar proportions?). A way of calculating this is to divide H’, the Shannon diversity index, by the natural logarithm (ln) of species richness that you have previously calculated. The <b>Shannon diversity index</b> is calculated as such:</p>

<p>
<b>H’ = -1 * sum of all ( <i>p</i>i * ln(<i>p</i>i))</b>, where <i>p</i>i in our case is the proportion of species i cover (ESTIMT_HA) relative to the cover of all species.</p>

<p>
Specifically, you should:
</p>

<li>Calculate the richness, the Shannon index, and the evenness for all three sites. <i>(Hint: some pipe chains involving our favourite dplyr functions may be useful here!)</i> </li>


<li>Be ready to answer the questions:
<ul>
<li> - <i>“Which area has the most species?” </i></li>
<li> - <i>“Which area has the lowest evenness?”</i></li>
</ul>
         </li>
    
        
</div>
</section>

<!-- Get started  -->
<section id="challenge2test" class="feature">
 
   <div class="container">
      <btn-switch onclick="toggle(challenge2test)" style="float: right;"> Hide/show background </btn-switch> 
  <div class="row">
    <div class="col-md-6">
      <h2>How to get started </h2>
      <p> Download the <a href="https://github.com/ourcodingclub/CC_course_challenge2" target="_blank">challenge repository</a>, which contains all the data you need, and create a new script for your challenge. Refer to this page to make sure you are answering all the questions. 
There is no script or code provided for this challenge: how you go about solving the tasks is entirely up to you! You may want to refer to the tutorials listed below (and other online resources). </p>

<h2> Finished? Take the test! </h2>
<p> Once you have a fully working script and have completed the specific tasks, take the test (INSERT LINK). </p>

    </div>
  </div>
</div>
</section>

<a name="hints"></a>
<!-- Help section -->
<section id="portfolio-work" style= "background-color: #6f6473; color: white">

        <div class="container">
         <center><h2>Help & hints </h2></center>
   <p>Here is a list of tutorials that might help you complete this challenge: </p>

<li> tutorial 1 </li>
<li> tutorial 2 </li>
<li> tutorial 3 </li>

<p> If you are stuck or don't know how to go about a specific task, the hints below may help you back on the right track: </p>

<li>Hint 1</li>
<li>Hint 2...</li>
         
         </div>
</section>

   
<!-- Acknowledgements section -->
<section id="portfolio-work" style= "background-color: #484b49; color: white">

        <div class="container">
         <center><h2>Acknowledgements </h2></center>
   <p>We thank all the organisations that provided open access data for this challenge. The datasets licences are as follow: </p>

<li><b>Scottish Natural Heritage (2018).</b> National Nature Reserves. Shapefile <a href="https://gateway.snh.gov.uk/natural-spaces/dataset.jsp?dsid=NNR" target="_blank">available here</a> under Open Government Licence (Crown copyright).</li><br>

<li><b>Forestry Commission (2018). </b>Native Woodland Survey of Scotland (NWSS). Available on <a href="http://data-forestry.opendata.arcgis.com/datasets/feadebb6bbf844a7bfdb5c8a7b9f73d7" target="_blank">Forestry Commission Open Data portal</a> under Open Governement licence (Crown copyright)</li><br>

<li><b>Forestry Commission (2018). </b>Native Woodland Survey of Scotland (NWSS) - Species structure. Available on <a href="http://data-forestry.opendata.arcgis.com/datasets/feadebb6bbf844a7bfdb5c8a7b9f73d7_6" target="_blank">Forestry Commission Open Data portal</a> under Open Governement licence (Crown copyright)</li><br>



         </div>
</section>

<!-- Back to course home  -->
 <section id="backhome">
        <div class="container">
         
         <center> <a class="btn" href="https://ourcodingclub.github.io/course_home">   <h3> Back to course home </h3> </a></center>

         </div>
</section>
   